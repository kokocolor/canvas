<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
	<title></title>
	<style type="text/css">
	body{
		overflow: hidden;
	}

	</style>
</head>
<body>
	<canvas id="canvas"></canvas>

	<script>
	window.onload=function(){
		var canvas=document.getElementById("canvas");
		var w,h;
		var ctx=canvas.getContext("2d");

		w=canvas.width=window.innerWidth;
		h=canvas.height=window.innerHeight;
		var list=[];
		var k=2;

		var img=new Image();
		img.src="img/p.png";

		function Dot(centerX, centerY, radius) {
			this.x = centerX;
			this.y = centerY;
			this.radius = radius;
		}

		img.onload=function(){

			var imgw=img.width,
				imgh=img.height;

			var sx=w/2-imgw/2;
			var sy=h/2-imgh/2;

			ctx.drawImage(img,sx,sy);
  
			var imgdata=ctx.getImageData(sx,sy,imgw,imgh);

			canvas.addEventListener("mousedown",function(){

				ctx.clearRect(0, 0, canvas.width, canvas.height);

				k=Math.random()*3;
				console.log(k);

		 
				for (var x =0; x <imgdata.width; x+=6) {
					for (var y =0; y <imgdata.height; y+=6) {

						var i=(y*imgdata.width+x)*4;
						if(imgdata.data[i+3]>100 ){
							var dot=new Dot(x,y,k);
							if(imgdata.data[i+1]<220 && imgdata.data[i+1]>200){

								dot.fillStyle="#ffd800";

							}else if(imgdata.data[i+1]<50 && imgdata.data[i+1]>30){

								dot.fillStyle="#ff2a06";

							}else if(imgdata.data[i+1]<90 && imgdata.data[i+1]>70){

								dot.fillStyle="#f75191";

							}else if(imgdata.data[i+1]<2 && imgdata.data[i+1]>0){

								dot.fillStyle="#000";

							}else if(imgdata.data[i+1]<160 && imgdata.data[i+1]>140){

								dot.fillStyle="#e39a00";

							}else if(imgdata.data[i+1]<255 && imgdata.data[i+1]>230){

								dot.fillStyle="#ffffff";

							}  
							// if(x%2== 0 && y%5 == 0){
							// 	dot.x=dot.x+Math.random()*4-2;
							// 	dot.y=dot.y+Math.random()*6-3;
							// }

							list.push(dot);
						}
	 
					 
					};
					 
				};

				draw();
	 		},false); 

			function draw(){
				  
				for(var i=0; i<list.length; i+=1){
					curDot = list[i];
					ctx.save();
					ctx.fillStyle=curDot.fillStyle;

					ctx.beginPath();
					ctx.arc(sx+curDot.x, sy+curDot.y, curDot.radius, 0, 2*Math.PI);
					ctx.fill();
			 
					ctx.restore();
				}
			}

 

		}
		 

	}


	</script>
</body>
</html>